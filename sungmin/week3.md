# 4장 불변 활용하기: 안정적으로 동작하게 만들기

## 4.1 재할당

- 변수에 값을 다시 할당하는 것을 재할당 또는 파괴적 할당이라고한다.
- 재할당은 변수에 의미를 바꿔 추측하기 어렵게 만들며, 언제 어떻게 변경되었는지 추적하기 힘들다.

### 4.1.1 불변 변수로 만들어서 재할당 막기

- 재할당을 막기 위해서는 변수에 `final` 수식자를 붙여서 사용한다.

### 4.1.2 매개변수도 불변으로 만들기

- 매개변수도 재할당을 막기 위해서 `final`을 붙여서 사용한다.

``` java
void addPrice(final int productPrice) {
    final int increasedTotalPrice = totalPrice + productPrice;

    if (MAX_TOTLA_PRICE < increasedTotalPrice) {
        throw new IllegalArgumentException("구매 상한 금액 초괴");
    }
}
```

## 4.2 가변으로 인해 발생하는 의도하지 않은 영향

- 인스턴스가 가변인 경우 다른 부분에 의도하지 않은 영향을 주기 쉽다.
- 코드를 변경했을 떄 생각하지도 못했던 위치에서 상태가 변화라여 예측하지 못한 동적을 하는 경우가 있다.

> 예시에 대한 설명은 책의 내용을 그대로 가져오는 것 같아 제외합니다.

## 4.3 불변과 가변은 어떻게 다루어야할까

### 4.3.1 기본적으로 불변으로

- 변수를 불변으로 만들면 다음과 같은 장점이 있다
  - 변수의 의미가 변하지 않으므로, 혼란을 줄일 수 있다.
  - 동작이 안정적이게 되므로 결과를 예측하기 쉽다.
  - 코드의 영향 범위가 한정적이므로 유지보수가 편해진다.

- 많은 프로그래밍 언어에서 변수 선언 시 불변으로 선언할 수 있는 키워드를 제공한다
  - 코틀린, 스칼라 : val
  - 자바스크립트 : const
  - 러스트는 기본이 불편

### 4.3.2 가변으로 설계해야하는 경우

- 기본적으로 불변으로 설계 하는 것이 좋지만 `성능`이 중요한 경우 가변으로 설계를 해야하는 경우도 있다.

### 4.3.3 상태를 변경하는 메서드 설계하기

- 인스턴스 변수를 가변으로 만들었다면, 메서드를 만들 때는 주의해야할 점이 있다.

### 4.3.4 코드 외부와 데이터 교환은 극소수하기

- 특별한 이유 없이 외부 상태에 의존하는 코드를 작성하면 동작 예측이 힘들어져 내부적 로직에서 문제가 발생할 가능성이 높아진다.
